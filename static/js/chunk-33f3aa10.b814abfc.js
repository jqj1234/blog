(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-33f3aa10","chunk-6a439ee7"],{"05d6":function(e,t,i){"use strict";i.d(t,"e",(function(){return l})),i.d(t,"k",(function(){return o})),i.d(t,"g",(function(){return r})),i.d(t,"f",(function(){return s})),i.d(t,"h",(function(){return c})),i.d(t,"b",(function(){return u})),i.d(t,"d",(function(){return d})),i.d(t,"l",(function(){return f})),i.d(t,"j",(function(){return m})),i.d(t,"a",(function(){return p})),i.d(t,"m",(function(){return h})),i.d(t,"i",(function(){return b})),i.d(t,"c",(function(){return g}));var n=i("b775"),a=i("c38a");function l(e){return Object(n["a"])({url:"/cms/blog/cms/cmsList",headers:{isToken:!1},method:"get",params:e,timeout:4e4})}function o(e){return Object(n["a"])({url:"/cms/blog/cms/detail/"+Object(a["f"])(e),headers:{isToken:!1},method:"get",timeout:4e4})}function r(e){return Object(n["a"])({url:"/cms/blog/cms/cmsListByType/"+e,headers:{isToken:!1},method:"get",timeout:4e4})}function s(e){return Object(n["a"])({url:"/cms/blog/cms/cmsListByTag/"+e,headers:{isToken:!1},method:"get",timeout:4e4})}function c(e){return Object(n["a"])({url:"/cms/blog/cms/cmsListRecommend",headers:{isToken:!1},method:"get",params:e,timeout:4e4})}function u(e){return Object(n["a"])({url:"/cms/blog/cms/addBlogViews/"+e,headers:{isToken:!1},method:"get",timeout:4e4})}function d(e){return Object(n["a"])({url:"/cms/blog/cms/cmsEssayList",headers:{isToken:!1},method:"get",params:e,timeout:4e4})}function f(e){return Object(n["a"])({url:"/cms/blog/list",method:"get",params:e})}function m(e){return Object(n["a"])({url:"/cms/blog/"+Object(a["f"])(e),method:"get"})}function p(e){return Object(n["a"])({url:"/cms/blog",method:"post",data:e})}function h(e){return Object(n["a"])({url:"/cms/blog",method:"put",data:e})}function b(e){return Object(n["a"])({url:"/cms/blog/"+e,method:"delete"})}function g(e){return Object(n["a"])({url:"/cms/blog/cancel",method:"post",data:e})}},"0d38":function(e,t,i){},"11bc":function(e,t,i){},"1a96":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("el-form",{directives:[{name:"show",rawName:"v-show",value:e.showSearch,expression:"showSearch"}],ref:"queryForm",attrs:{model:e.queryParams,inline:!0,"label-width":"68px"}},[i("el-form-item",{attrs:{label:"标题",prop:"title"}},[i("el-input",{attrs:{placeholder:"请输入标题",clearable:"",size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams.title,callback:function(t){e.$set(e.queryParams,"title",t)},expression:"queryParams.title"}})],1),i("el-form-item",{attrs:{label:"状态",prop:"status"}},[i("el-select",{attrs:{placeholder:"请选择状态",clearable:"",size:"small"},model:{value:e.queryParams.status,callback:function(t){e.$set(e.queryParams,"status",t)},expression:"queryParams.status"}},e._l(e.dict.type.cms_blog_status,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-form-item",[i("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:e.handleQuery}},[e._v("搜索")]),i("el-button",{attrs:{icon:"el-icon-refresh",size:"mini"},on:{click:e.resetQuery}},[e._v("重置")])],1)],1),i("el-row",{staticClass:"mb8",attrs:{gutter:10}},[i("el-col",{attrs:{span:1.5}},[i("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["cms:blog:add"],expression:"['cms:blog:add']"}],attrs:{type:"primary",plain:"",icon:"el-icon-plus",size:"mini"},on:{click:e.handleAdd}},[e._v("新增")])],1),i("el-col",{attrs:{span:1.5}},[i("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["cms:blog:edit"],expression:"['cms:blog:edit']"}],attrs:{type:"success",plain:"",icon:"el-icon-edit",size:"mini",disabled:e.single},on:{click:e.handleUpdate}},[e._v("修改")])],1),i("el-col",{attrs:{span:1.5}},[i("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["cms:blog:remove"],expression:"['cms:blog:remove']"}],attrs:{type:"danger",plain:"",icon:"el-icon-delete",size:"mini",disabled:e.multiple},on:{click:e.handleDelete}},[e._v("删除")])],1),i("el-col",{attrs:{span:1.5}},[i("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["cms:blog:export"],expression:"['cms:blog:export']"}],attrs:{type:"warning",plain:"",icon:"el-icon-download",size:"mini"},on:{click:e.handleExport}},[e._v("导出")])],1),i("right-toolbar",{attrs:{showSearch:e.showSearch},on:{"update:showSearch":function(t){e.showSearch=t},"update:show-search":function(t){e.showSearch=t},queryTable:e.getList}})],1),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.blogList,"row-class-name":e.tableRowClassName},on:{"selection-change":e.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),i("el-table-column",{attrs:{label:"首图预览",align:"center",prop:"blogPic"},scopedSlots:e._u([{key:"default",fn:function(t){return["0"==t.row.blogPicType?i("el-image",{staticStyle:{width:"120px",height:"60px"},attrs:{src:t.row.blogPicLink,lazy:"","preview-src-list":[t.row.blogPicLink]}},[i("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[i("el-image",{staticClass:"blogPic",attrs:{src:"/errorImg.jpg",fit:"cover"}})],1)]):e._e(),"1"==t.row.blogPicType?i("el-image",{staticStyle:{width:"120px",height:"60px"},attrs:{src:t.row.blogPic,lazy:"","preview-src-list":[t.row.blogPic]}}):e._e()]}}])}),i("el-table-column",{attrs:{label:"标题",align:"center",prop:"title"}}),i("el-table-column",{attrs:{label:"分类",align:"center",prop:"types"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.types,(function(t){return i("el-tag",{key:t.typeId,attrs:{size:"mini",type:"info"}},[e._v(e._s(t.typeName))])}))}}])}),i("el-table-column",{attrs:{label:"标签",align:"center",prop:"tags"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.tags,(function(t){return i("el-tag",{key:t.tagId,attrs:{effect:"plain",size:"mini",type:"success"}},[e._v(" "+e._s(t.tagName))])}))}}])}),i("el-table-column",{attrs:{label:"阅读量",align:"center",prop:"views"}}),i("el-table-column",{attrs:{label:"状态",align:"center",prop:"status"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("dict-tag",{attrs:{options:e.dict.type.cms_blog_status,value:t.row.status}})]}}])}),i("el-table-column",{attrs:{label:"创建者",align:"center",prop:"createBy"}}),i("el-table-column",{attrs:{label:"创建时间",align:"center",prop:"createTime",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e.parseTime(t.row.createTime,"{y}-{m}-{d} {h}:{i}:{s}")))])]}}])}),i("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["cms:blog:edit"],expression:"['cms:blog:edit']"}],attrs:{size:"mini",type:"text",icon:"el-icon-edit"},on:{click:function(i){return e.handleUpdate(t.row)}}},[e._v("修改")]),i("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["cms:blog:remove"],expression:"['cms:blog:remove']"}],attrs:{size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(i){return e.handleDelete(t.row)}}},[e._v("删除")]),i("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["cms:blog:edit"],expression:"['cms:blog:edit']"}],attrs:{size:"mini",type:"text",icon:"el-icon-folder-opened"},on:{click:function(i){return e.blogFiles(t.row)}}},[e._v("附件管理")])]}}])})],1),i("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.queryParams.pageNum,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getList}}),i("el-dialog",{attrs:{title:e.title,visible:e.open,"before-close":e.cancel,width:"1200px","append-to-body":""},on:{"update:visible":function(t){e.open=t}}},[i("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[i("el-form-item",{attrs:{label:"标题",prop:"title"}},[i("el-input",{attrs:{placeholder:"请输入标题"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),i("el-row",[i("el-col",{attrs:{span:8}},[i("el-form-item",{attrs:{label:"首图"}},[i("el-radio-group",{model:{value:e.form.blogPicType,callback:function(t){e.$set(e.form,"blogPicType",t)},expression:"form.blogPicType"}},[i("el-radio-button",{attrs:{label:"0"}},[e._v("地址")]),i("el-radio-button",{attrs:{label:"1"}},[e._v("上传")])],1),i("div",{directives:[{name:"show",rawName:"v-show",value:"0"==e.form.blogPicType,expression:"form.blogPicType == '0'"}],staticClass:"tabBlock"},[i("el-input",{staticStyle:{"margin-bottom":"10px"},attrs:{placeholder:"请输入图片地址 https://"},model:{value:e.form.blogPicLink,callback:function(t){e.$set(e.form,"blogPicLink",t)},expression:"form.blogPicLink"}}),i("el-image",{staticClass:"blogPic",attrs:{src:e.form.blogPicLink,"preview-src-list":[e.form.blogPicLink],fit:"cover"}},[i("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[i("el-image",{staticClass:"blogPic",attrs:{src:"/errorImg.jpg",fit:"cover"}})],1)])],1),i("div",{directives:[{name:"show",rawName:"v-show",value:"1"==e.form.blogPicType,expression:"form.blogPicType == '1'"}],staticClass:"tabBlock"},[i("imageUpload",{attrs:{limit:1},model:{value:e.form.blogPic,callback:function(t){e.$set(e.form,"blogPic",t)},expression:"form.blogPic"}})],1)],1)],1),i("el-col",{attrs:{span:16}},[i("el-form-item",{attrs:{label:"简介"}},[i("el-input",{attrs:{type:"textarea",autosize:{minRows:7,maxRows:7},maxlength:"50","show-word-limit":"",placeholder:"请输入简介"},model:{value:e.form.blogDesc,callback:function(t){e.$set(e.form,"blogDesc",t)},expression:"form.blogDesc"}})],1)],1)],1),i("el-form-item",{attrs:{label:"内容"}},[i("el-row",{staticStyle:{"margin-bottom":"20px"}},[i("el-col",{attrs:{align:"right"}},[i("span",{directives:[{name:"show",rawName:"v-show",value:"2"===e.form.contentType,expression:"form.contentType ==='2'"}],staticStyle:{color:"#E6A23C","margin-right":"20px"}},[e._v("Markdown编辑器保存后会覆盖其他富文本编辑器内容")]),e._v(" 编辑器： "),i("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.contentType,callback:function(t){e.$set(e.form,"contentType",t)},expression:"form.contentType"}},[i("el-option",{key:"1",attrs:{label:"Quill富文本编辑器",value:"1"}}),i("el-option",{key:"2",attrs:{label:"CherryMarkdown (推荐)",value:"2"}}),i("el-option",{key:"3",attrs:{label:"Tinymce富文本编辑器",value:"3"}})],1)],1)],1),i("el-row",[i("el-col",["1"===e.form.contentType?i("cmsEditor",{attrs:{type:"base64","min-height":192},on:{getFileId:e.getFileId},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}}):e._e(),"2"===e.form.contentType?i("CherryMarkdown",{ref:"CherryMarkdown",attrs:{height:400},model:{value:e.form.contentMarkdown,callback:function(t){e.$set(e.form,"contentMarkdown",t)},expression:"form.contentMarkdown"}}):e._e(),"3"===e.form.contentType?i("Tinymce",{attrs:{height:400},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}}):e._e()],1)],1)],1),i("el-form-item",{attrs:{label:"标签"}},[i("el-checkbox-group",{model:{value:e.form.tagIds,callback:function(t){e.$set(e.form,"tagIds",t)},expression:"form.tagIds"}},e._l(e.tagOptions,(function(t){return i("el-checkbox",{key:t.tagId,attrs:{label:t.tagId,value:t.tagId}},[e._v(" "+e._s(t.tagName)+" ")])})),1)],1),i("el-row",[i("el-col",{attrs:{span:7}},[i("el-form-item",{attrs:{label:"分类"}},[i("el-select",{attrs:{multiple:"",placeholder:"请选择",filterable:"",clearable:""},model:{value:e.form.typeIds,callback:function(t){e.$set(e.form,"typeIds",t)},expression:"form.typeIds"}},e._l(e.typeOptions,(function(e){return i("el-option",{key:e.typeId,attrs:{label:e.typeName,value:e.typeId}})})),1)],1)],1),i("el-col",{attrs:{span:17}},[i("el-form-item",{attrs:{label:"置顶"}},[i("el-checkbox",{model:{value:e.top,callback:function(t){e.top=t},expression:"top"}})],1)],1)],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:e.releaseForm}},[e._v("发 布")]),i("el-button",{attrs:{type:"info"},on:{click:e.saveForm}},[e._v("暂 存")]),i("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1)],1),i("el-dialog",{attrs:{title:e.title,visible:e.fileListOpen,width:"1000px","append-to-body":""},on:{"update:visible":function(t){e.fileListOpen=t}}},[i("el-table",{staticClass:"file-list",attrs:{data:e.fileInfoList}},[i("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),i("el-table-column",{attrs:{label:"图片预览",align:"center",prop:"pic"},scopedSlots:e._u([{key:"default",fn:function(e){return[i("el-image",{staticStyle:{width:"120px",height:"60px"},attrs:{src:e.row.pic,lazy:"","preview-src-list":[e.row.pic]}})]}}])}),i("el-table-column",{attrs:{label:"文件名称",align:"center",prop:"fileOriginName"}}),i("el-table-column",{attrs:{label:"文件类型",align:"center",prop:"fileSuffix"}}),i("el-table-column",{attrs:{label:"文件大小",align:"center",prop:"fileSizeInfo"}}),i("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-download"},on:{click:function(i){return e.handleDownload(t.row)}}},[e._v("下载")])]}}])})],1)],1),i("el-dialog",{attrs:{title:"附件管理",visible:e.blogFilesOpen,"before-close":e.cancel,width:"1200px","append-to-body":""},on:{"update:visible":function(t){e.blogFilesOpen=t}}},[i("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-position":"top","label-width":"80px"}},[i("el-form-item",[i("el-row",[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.addFiles}},[e._v("添加文件")]),i("el-table",{staticStyle:{width:"99.99%"},attrs:{data:e.form.blogFilesNew,border:!0}},[i("el-table-column",{attrs:{align:"center","min-width":"20%",prop:"pic",label:"附件"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("filesUpload",{attrs:{"is-show-tip":!1},on:{handleFilesSuccess:e.filesSuccess},model:{value:t.row.fileId,callback:function(i){e.$set(t.row,"fileId",i)},expression:"scope.row.fileId"}})]}}])}),i("el-table-column",{attrs:{align:"center","min-width":"20%",prop:"remark",label:"文件信息"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-row",[i("el-col",{attrs:{span:6}},[i("div",{staticClass:"blogFilesInfoName"},[e._v("名称：")])]),i("el-col",{attrs:{span:18}},[i("el-input",{attrs:{disabled:""},model:{value:t.row.fileOriginName,callback:function(i){e.$set(t.row,"fileOriginName",i)},expression:"scope.row.fileOriginName"}})],1)],1),i("el-row",{staticStyle:{"margin-top":"4px"}},[i("el-col",{attrs:{span:6}},[i("div",{staticClass:"blogFilesInfoName"},[e._v("大小：")])]),i("el-col",{attrs:{span:18}},[i("el-input",{attrs:{disabled:""},model:{value:t.row.fileSize,callback:function(i){e.$set(t.row,"fileSize",i)},expression:"scope.row.fileSize"}})],1)],1),i("el-row",{staticStyle:{"margin-top":"4px"}},[i("el-col",{attrs:{span:6}},[i("div",{staticClass:"blogFilesInfoName"},[e._v("类型：")])]),i("el-col",{attrs:{span:18}},[i("el-input",{attrs:{disabled:""},model:{value:t.row.fileSuffix,callback:function(i){e.$set(t.row,"fileSuffix",i)},expression:"scope.row.fileSuffix"}})],1)],1)]}}])}),i("el-table-column",{attrs:{align:"center","min-width":"40%",prop:"remark",label:"备注"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-input",{attrs:{type:"textarea",rows:6,size:"small"},model:{value:t.row.remark,callback:function(i){e.$set(t.row,"remark",i)},expression:"scope.row.remark"}})]}}])}),i("el-table-column",{attrs:{align:"center","min-width":"20%",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{directives:[{name:"show",rawName:"v-show",value:""!==t.row.fileId,expression:"scope.row.fileId!==''"}],attrs:{size:"mini",plain:""},on:{click:function(i){return e.handleDownload(t.row)}}},[e._v("下载")]),i("el-button",{attrs:{size:"mini",type:"danger",plain:""},on:{click:function(i){return e.delFiles(t.$index,t.row)}}},[e._v("删除")])]}}])})],1)],1)],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:e.saveBlogFiles}},[e._v("保 存")]),i("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1)],1)],1)},a=[],l=i("5530"),o=(i("d81d"),i("b64b"),i("a434"),i("ac1f"),i("5319"),i("d3b7"),i("25f0"),i("159b"),i("e9c4"),i("c202")),r=i("6ee1"),s=i("8256"),c=i("05d6"),u=i("3be1"),d=i("f975"),f=i("5c96"),m={name:"Blog",dicts:["cms_blog_status"],components:{filesUpload:o["default"],CherryMarkdown:r["a"],Tinymce:s["a"]},data:function(){return{loading:!0,ids:[],names:[],single:!0,multiple:!0,showSearch:!0,total:0,blogList:[],fileInfoList:[],title:"",open:!1,fileListOpen:!1,blogFilesOpen:!1,queryParams:{pageNum:1,pageSize:10,title:null,type:1,content:null,top:null,views:null,status:null,createBy:null},form:{},top:!1,rules:{title:[{required:!0,message:"标题不能为空",trigger:"blur"}],type:[{required:!0,message:"类型不能为空",trigger:"change"}]},fileIds:[],typeOptions:[],tagOptions:[]}},created:function(){this.getList()},methods:{getList:function(){var e=this;this.loading=!0,Object(c["l"])(this.queryParams).then((function(t){for(var i=0;i<t.rows.length;i++){var n=t.rows[i];n.blogPic.length>0?t.rows[i].blogPic="/prod-api"+n.blogPic:t.rows[i].blogPic="/errorImg.jpg",0==n.blogPicLink.length&&(t.rows[i].blogPicLink="/errorImg.jpg")}e.blogList=t.rows,e.total=t.total,e.loading=!1}))},cancel:function(){var e=this;this.$confirm("是否放弃此次编辑？","系统提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t=e.fileIds;t.length>0&&Object(u["b"])(t),e.fileIds.length=0,Object(c["c"])(e.form).then((function(e){})),e.top=!1,e.open=!1,e.blogFilesOpen=!1,e.reset()})).catch((function(){}))},reset:function(){this.form={id:null,createBy:null,createTime:null,updateBy:null,updateTime:null,title:null,type:1,content:null,top:"0",views:null,status:"0",blogDesc:null,blogFiles:null,blogPicType:"0",blogPic:null,blogPicLink:null,tagIds:[],typeIds:[],blogFilesNew:[],contentType:"1",contentMarkdown:null},this.resetForm("form")},handleQuery:function(){this.queryParams.pageNum=1,this.getList()},resetQuery:function(){this.resetForm("queryForm"),this.handleQuery()},handleSelectionChange:function(e){this.ids=e.map((function(e){return e.id})),this.names=e.map((function(e){return e.title})),this.single=1!==e.length,this.multiple=!e.length},handleAdd:function(){var e=this;Object(c["j"])().then((function(t){e.typeOptions=t.types,e.tagOptions=t.tags,e.reset(),e.open=!0,e.title="添加文章"}))},handleUpdate:function(e){var t=this;this.reset();var i=e.id||this.ids;Object(c["j"])(i).then((function(e){t.typeOptions=e.types,t.tagOptions=e.tags,t.form=e.data,1==t.form.top&&(t.top=!0),t.open=!0,t.title="修改文章"}))},releaseForm:function(){var e=this;this.$refs["form"].validate((function(t){t&&e.$modal.confirm("是否确认发布？").then((function(){e.form.type=1,e.form.status=1,e.top?e.form.top=1:e.form.top=0,"2"===e.form.contentType&&e.setFormContent(),null!=e.form.id?Object(c["m"])(e.form).then((function(t){if(e.fileIds.length>0){var i={blogId:e.form.id,fileIds:e.fileIds};Object(d["a"])(i).then((function(e){}))}e.$modal.msgSuccess("发布成功"),e.fileIds.length=0,e.open=!1,e.getList()})):Object(c["a"])(e.form).then((function(t){if(e.fileIds.length>0){var i={blogId:t.data,fileIds:e.fileIds};Object(d["a"])(i).then((function(e){}))}e.$modal.msgSuccess("发布成功"),e.fileIds.length=0,e.open=!1,e.getList()}))})).catch((function(){}))}))},saveForm:function(){var e=this;this.$refs["form"].validate((function(t){t&&e.$modal.confirm("是否确认暂存？").then((function(){e.form.type=1,e.form.status=0,e.top?e.form.top=1:e.form.top=0,"2"===e.form.contentType&&e.setFormContent(),null!=e.form.id?Object(c["m"])(e.form).then((function(t){if(e.fileIds.length>0){var i={blogId:e.form.id,fileIds:e.fileIds};Object(d["a"])(i).then((function(e){}))}e.$modal.msgSuccess("暂存成功"),e.fileIds.length=0,e.open=!1,e.getList()})):Object(c["a"])(e.form).then((function(t){if(e.fileIds.length>0){var i={blogId:t.data,fileIds:e.fileIds};Object(d["a"])(i).then((function(e){}))}e.$modal.msgSuccess("暂存成功"),e.fileIds.length=0,e.open=!1,e.getList()}))})).catch((function(){}))}))},handleDelete:function(e){var t=this,i=e.id||this.ids,n=e.title||this.names;this.$modal.confirm('是否确认删除"'+n+'"？').then((function(){return Object(d["b"])(i).then().then((function(e){})),Object(c["i"])(i)})).then((function(){t.getList(),t.$modal.msgSuccess("删除成功")})).catch((function(){}))},handleExport:function(){this.download("cms/blog/export",Object(l["a"])({},this.queryParams),"blog_".concat((new Date).getTime(),".xlsx"))},getFileId:function(e){this.fileIds.push(e)},fileList:function(e){var t=this,i=f["Loading"].service({target:".file-list"});this.reset();var n=e.id||this.ids;Object(d["c"])(n).then((function(e){for(var n=0;n<e.data.length;n++){var a=e.data[n];switch(a.fileSuffix){case"png":case"jpg":case"jpeg":case"bmp":case"gif":e.data[n].pic="/prod-api"+a.filePath;break;default:e.data[n].pic=image.bg1;break}}t.fileInfoList=e.data,t.fileListOpen=!0,t.title="资源列表",setTimeout((function(){i.close()}),100)}))},blogFiles:function(e){var t=this;this.reset();var i=e.id||this.ids;Object(c["j"])(i).then((function(e){t.typeOptions=e.types,t.tagOptions=e.tags,t.form=e.data,t.form.blogFilesNew=[],null!==e.data.blogFiles&&(t.form.blogFilesNew=JSON.parse(e.data.blogFiles)),1==t.form.top&&(t.top=!0),t.blogFilesOpen=!0}))},addFiles:function(){this.form.blogFilesNew.push({id:this.uuid(),fileId:"",fileOriginName:"",fileSuffix:"",fileSize:"",filePath:"",remark:""})},delFiles:function(e,t){var i=this;this.$confirm("确认删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){for(var e=i.form.blogFilesNew,n=0;n<e.length;n++)t.id===e[n].id&&i.form.blogFilesNew.splice(n,1)})).catch((function(){}))},uuid:function(){var e=(new Date).getTime();window.performance&&"function"===typeof window.performance.now&&(e+=performance.now());var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var i=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?i:3&i|8).toString(16)}));return t},filesSuccess:function(e){this.form.blogFilesNew.forEach((function(t){t.fileId===e.fileId&&(t.fileOriginName=e.fileOriginName,t.fileSuffix=e.fileSuffix,t.fileSize=e.fileSize,t.filePath=e.filePath)}))},saveBlogFiles:function(){var e=this;if(this.form.blogFilesNew.length>0)for(var t=0;t<this.form.blogFilesNew.length;t++){var i=this.form.blogFilesNew[t];if(""===i.fileId)return this.$message.warning("请添加文件或删除空行！"),!1;if(""===i.remark)return this.$message.warning("请添加文件备注！"),!1}this.form.blogFiles=JSON.stringify(this.form.blogFilesNew),Object(c["m"])(this.form).then((function(t){e.$modal.msgSuccess("保存成功"),e.blogFilesOpen=!1,e.getList()}))},handleDownload:function(e){var t=e.fileOriginName,i=e.filePath,n=(i.substring(i.lastIndexOf("."),i.length),document.createElement("a"));n.setAttribute("download",t),n.setAttribute("target","_blank"),n.setAttribute("href","/prod-api"+i),n.click()},tableRowClassName:function(e){var t=e.row;e.rowIndex;return 1==t.top?"warning-row":""},setFormContent:function(){this.form.content=this.$refs.CherryMarkdown.getCherryHtml()}}},p=m,h=(i("45b6"),i("2877")),b=Object(h["a"])(p,n,a,!1,null,"700b6ad0",null);t["default"]=b.exports},"2f81":function(e,t,i){},"34fa":function(e,t,i){"use strict";i("910c")},"3be1":function(e,t,i){"use strict";i.d(t,"d",(function(){return a})),i.d(t,"c",(function(){return l})),i.d(t,"a",(function(){return o})),i.d(t,"e",(function(){return r})),i.d(t,"b",(function(){return s}));var n=i("b775");function a(e){return Object(n["a"])({url:"/fileInfo/list",method:"get",params:e})}function l(e){return Object(n["a"])({url:"/fileInfo/"+e,method:"get"})}function o(e){return Object(n["a"])({url:"/fileInfo",method:"post",data:e})}function r(e){return Object(n["a"])({url:"/fileInfo",method:"put",data:e})}function s(e){return Object(n["a"])({url:"/fileInfo/"+e,method:"delete"})}},"3fa8":function(e,t,i){"use strict";i("0d38")},"45b6":function(e,t,i){"use strict";i("11bc")},8256:function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tinymce-container",class:{fullscreen:e.fullscreen},style:{width:e.containerWidth}},[i("textarea",{staticClass:"tinymce-textarea",attrs:{id:e.tinymceId}}),e._v(" "),i("div",{staticClass:"editor-custom-btn-container"})])},a=[],l=i("ade3"),o=(i("b680"),i("a9e3"),i("ac1f"),i("00b4"),i("d3b7"),i("159b"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"upload-container"},[i("el-button",{style:{background:e.color,borderColor:e.color},attrs:{icon:"el-icon-upload",size:"mini",type:"primary"},on:{click:function(t){e.dialogVisible=!0}}},[e._v(" 上传图片 ")]),i("el-dialog",{attrs:{visible:e.dialogVisible,modal:!1,title:"上传图片"},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("el-row",{staticStyle:{"padding-top":"20px"}},[i("el-col",{attrs:{span:24}},[i("el-upload",{staticClass:"editor-slide-upload",attrs:{multiple:!0,"file-list":e.fileList,"show-file-list":!0,"on-remove":e.handleRemove,"on-success":e.handleSuccess,"on-error":e.handleUploadError,"before-upload":e.beforeUpload,headers:e.headers,action:e.uploadUrl,"list-type":"picture-card"}},[i("el-button",{attrs:{size:"small",type:"primary"}},[e._v(" 点击上传 ")])],1)],1)],1),i("el-row",[i("el-col",{staticStyle:{"text-align":"right"},attrs:{span:24}},[i("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v(" 取消 ")]),i("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v(" 确认 ")])],1)],1)],1)],1)}),r=[],s=(i("b64b"),i("d81d"),i("3ca3"),i("ddb0"),i("2b3d"),i("9861"),i("5f87")),c={name:"EditorSlideUpload",props:{color:{type:String,default:"#1890ff"}},data:function(){return{uploadUrl:"/prod-api/common/upload",headers:{Authorization:"Bearer "+Object(s["a"])()},dialogVisible:!1,listObj:{},fileList:[]}},computed:{},methods:{checkAllSuccess:function(){var e=this;return Object.keys(this.listObj).every((function(t){return e.listObj[t].hasSuccess}))},handleSubmit:function(){var e=this,t=Object.keys(this.listObj).map((function(t){return e.listObj[t]}));this.checkAllSuccess()?(this.$emit("successCBK",t),this.listObj={},this.fileList=[],this.dialogVisible=!1):this.$message("Please wait for all images to be uploaded successfully. If there is a network problem, please refresh the page and upload again!")},handleSuccess:function(e,t){for(var i=t.fileId,n=Object.keys(this.listObj),a=0,l=n.length;a<l;a++)if(this.listObj[n[a]].fileId===i)return this.listObj[n[a]].url="/prod-api"+e.fileName,void(this.listObj[n[a]].hasSuccess=!0)},handleRemove:function(e){for(var t=e.fileId,i=Object.keys(this.listObj),n=0,a=i.length;n<a;n++)if(this.listObj[i[n]].fileId===t)return void delete this.listObj[i[n]]},beforeUpload:function(e){var t=this,i=window.URL||window.webkitURL,n=e.fileId;return this.listObj[n]={},new Promise((function(a,l){var o=new Image;o.src=i.createObjectURL(e),o.onload=function(){t.listObj[n]={hasSuccess:!1,fileId:e.fileId,width:this.width,height:this.height}},a(!0)}))},handleUploadError:function(){this.$message.error("图片插入失败")}}},u=c,d=(i("c65d"),i("2877")),f=Object(d["a"])(u,o,r,!1,null,"9b3f7ed8",null),m=f.exports,p=["advlist anchor autolink autosave charmap code codesample colorpicker contextmenu directionality emoticons fullscreen hr image imagetools insertdatetime link lists media nonbreaking noneditable pagebreak paste preview print save searchreplace spellchecker tabfocus table template textcolor textpattern visualblocks visualchars wordcount"],h=p,b=["searchreplace bold fontsizeselect fontselect  italic underline strikethrough alignleft aligncenter alignright outdent indent  blockquote undo redo removeformat subscript superscript code codesample","hr bullist numlist link image charmap preview lineheight anchor pagebreak insertdatetime media table emoticons forecolor backcolor fullscreen"],g=b,v=i("b85c"),y=[];function w(){return window.tinymce}var k=function(e,t){var i=document.getElementById(e),n=t||function(){};if(!i){var a=document.createElement("script");a.src=e,a.id=e,document.body.appendChild(a),y.push(n);var l="onload"in a?o:r;l(a)}function o(t){t.onload=function(){this.onerror=this.onload=null;var e,i=Object(v["a"])(y);try{for(i.s();!(e=i.n()).done;){var n=e.value;n(null,t)}}catch(a){i.e(a)}finally{i.f()}y=null},t.onerror=function(){this.onerror=this.onload=null,n(new Error("Failed to load "+e),t)}}function r(e){e.onreadystatechange=function(){if("complete"===this.readyState||"loaded"===this.readyState){this.onreadystatechange=null;var t,i=Object(v["a"])(y);try{for(i.s();!(t=i.n()).done;){var n=t.value;n(null,e)}}catch(a){i.e(a)}finally{i.f()}y=null}}}i&&n&&(w()?n(null,i):y.push(n))},x=k,O=i("bc3a"),_=i.n(O),S=window.location.origin+"/Tinymce/tinymce.min.js",j={name:"Tinymce",components:{editorImage:m},props:{id:{type:String,default:function(){return"vue-tinymce-"+ +new Date+(1e3*Math.random()).toFixed(0)}},value:{type:String,default:""},toolbar:{type:Array,required:!1,default:function(){return[]}},menubar:{type:String,default:"file edit insert view format table"},height:{type:[Number,String],required:!1,default:360},width:{type:[Number,String],required:!1,default:"auto"},disabled:{type:[Boolean],required:!1,default:!1}},data:function(){return{hasChange:!1,hasInit:!1,tinymceId:this.id,fullscreen:!1,languageTypeList:{en:"en",zh:"zh_CN",es:"es_MX",ja:"ja"}}},computed:{containerWidth:function(){var e=this.width;return/^[\d]+(\.[\d]+)?$/.test(e)?"".concat(e,"px"):e}},watch:{value:function(e){var t=this;null!==e&&!this.hasChange&&this.hasInit&&this.$nextTick((function(){return window.tinymce.get(t.tinymceId).setContent(e||"")}))}},mounted:function(){this.init()},activated:function(){window.tinymce&&this.initTinymce()},deactivated:function(){this.destroyTinymce()},destroyed:function(){this.destroyTinymce()},methods:{init:function(){var e=this;x(S,(function(t){t?e.$message.error(t.message):e.initTinymce()}))},initTinymce:function(){var e,t=this,i=this;window.tinymce.init((e={readonly:this.disabled,branding:!1,selector:"#".concat(this.tinymceId),language:this.languageTypeList["zh"],images_upload_handler:function(e,t,i){if(e.blob().size/1024/1024>2)i("上传失败，图片大小请控制在 2M 以内");else{var n=new FormData;n.append("file",e.blob());var a={headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+Object(s["a"])()}};_.a.post("/prod-api/common/upload",n,a).then((function(e){console.log(e),t("/prod-api"+e.data.fileName)})).catch((function(){i("上传出错，服务器开小差了呢")}))}},font_formats:"Andale Mono=andale mono,times; Arial=arial,helvetica,sans-serif; Arial Black=arial black,avant garde; Book Antiqua=book antiqua,palatino; Comic Sans MS=comic sans ms,sans-serif; Courier New=courier new,courier; Georgia=georgia,palatino; Helvetica=helvetica; Impact=impact,chicago; Symbol=symbol; Tahoma=tahoma,arial,helvetica,sans-serif; Terminal=terminal,monaco; Times New Roman=times new roman,times; Trebuchet MS=trebuchet ms,geneva; Verdana=verdana,geneva; Webdings=webdings; Wingdings=wingdings,zapf dingbats",height:this.height,body_class:"panel-body ",object_resizing:!1,toolbar:this.toolbar.length>0?this.toolbar:g,menubar:this.menubar,fontsize_formats:"8pt 10pt 12pt 14pt 16pt 18pt 24pt 36pt 48pt"},Object(l["a"])(e,"font_formats","微软雅黑='微软雅黑';宋体='宋体';黑体='黑体';仿宋='仿宋';楷体='楷体';隶书='隶书';幼圆='幼圆';Andale Mono=andale mono,times;Arial=arial,helvetica,sans-serif;Arial Black=arial black,avant garde;Book Antiqua=book antiqua,palatino;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier;Georgia=georgia,palatino;Helvetica=helvetica;Impact=impact,chicago;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco;Times New Roman=times new roman,times;Trebuchet MS=trebuchet ms,geneva;Verdana=verdana,geneva;Webdings=webdings;Wingdings=wingdings"),Object(l["a"])(e,"lineheight_formats","1 1.1 1.2 1.3 1.4 1.5 2"),Object(l["a"])(e,"plugins",h),Object(l["a"])(e,"end_container_on_empty_block",!0),Object(l["a"])(e,"powerpaste_word_import","clean"),Object(l["a"])(e,"code_dialog_height",450),Object(l["a"])(e,"code_dialog_width",1e3),Object(l["a"])(e,"advlist_bullet_styles","square"),Object(l["a"])(e,"advlist_number_styles","default"),Object(l["a"])(e,"imagetools_cors_hosts",["www.tinymce.com","codepen.io"]),Object(l["a"])(e,"default_link_target","_blank"),Object(l["a"])(e,"link_title",!1),Object(l["a"])(e,"nonbreaking_force_tab",!0),Object(l["a"])(e,"init_instance_callback",(function(e){i.value&&e.setContent(i.value),i.hasInit=!0,e.on("NodeChange Change KeyUp SetContent",(function(){t.hasChange=!0,t.$emit("input",e.getContent())}))})),Object(l["a"])(e,"setup",(function(e){e.on("FullscreenStateChanged",(function(e){i.fullscreen=e.state}))})),Object(l["a"])(e,"templates",[{title:"Some title 1",description:"Some desc 1",content:"这是模板内容。"}]),Object(l["a"])(e,"convert_urls",!1),e))},destroyTinymce:function(){var e=window.tinymce.get(this.tinymceId);this.fullscreen&&e.execCommand("mceFullScreen"),e&&e.destroy()},setContent:function(e){window.tinymce.get(this.tinymceId).setContent(e)},getContent:function(){window.tinymce.get(this.tinymceId).getContent()},imageSuccessCBK:function(e){var t=this;e.forEach((function(e){return window.tinymce.get(t.tinymceId).insertContent('<img class="wscnph" src="'.concat(e.url,'" >'))}))}}},I=j,T=(i("3fa8"),Object(d["a"])(I,n,a,!1,null,"fb7cca5a",null));t["a"]=T.exports},"910c":function(e,t,i){},c202:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"component-upload-image"},[i("el-upload",{class:{hide:this.fileList.length>=this.limit},attrs:{disabled:e.disabled,action:e.uploadImgUrl,"list-type":"picture-card","on-success":e.handleUploadSuccess,"before-upload":e.handleBeforeUpload,limit:e.limit,"on-error":e.handleUploadError,name:"file","on-remove":e.handleRemove,"show-file-list":!0,headers:e.headers,"file-list":e.fileList}},[i("i",{staticClass:"el-icon-plus"})]),e.showTip?i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(" 请上传 "),e.fileSize?[e._v(" 大小不超过 "),i("b",{staticStyle:{color:"#f56c6c"}},[e._v(e._s(e.fileSize)+"MB")])]:e._e(),e.fileType?[e._v(" 格式为 "),i("b",{staticStyle:{color:"#f56c6c"}},[e._v(e._s(e.fileType.join("/")))])]:e._e(),e._v(" 的文件 ")],2):e._e()],1)},a=[],l=(i("a9e3"),i("d81d"),i("b0c0"),i("a434"),i("fb6a"),i("d3b7"),i("a15b"),i("ac1f"),i("5319"),i("5f87")),o={props:{value:[String,Object,Array],fileSize:{type:Number,default:10},fileType:{type:Array,default:function(){return["doc","xls","ppt","pdf","png","jpg","jpeg","zip","7z","wps"]}},isShowTip:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1}},data:function(){return{limit:1,hideUpload:!1,baseUrl:"/prod-api",uploadImgUrl:"/prod-api/common/upload",headers:{Authorization:"Bearer "+Object(l["a"])()},fileList:[]}},watch:{value:{handler:function(e){var t=this;if(!e)return this.fileList=[],[];var i=Array.isArray(e)?e:this.value.split(",");this.fileList=i.map((function(e){return"string"===typeof e&&(e=-1===e.indexOf(t.baseUrl)?{name:t.baseUrl+e,url:"/file.png"}:{name:e,url:e}),e}))},deep:!0,immediate:!0}},computed:{showTip:function(){return this.isShowTip&&(this.fileType||this.fileSize)}},methods:{handleRemove:function(e,t){var i=this.fileList.map((function(e){return e.name})).indexOf(e.name);i>-1&&(this.fileList.splice(i,1),this.$emit("input",this.listToString(this.fileList)))},handleUploadSuccess:function(e){this.fileList.push({name:e.fileName,url:e.fileName}),this.$emit("input",this.listToString(this.fileList));var t={fileId:this.listToString(this.fileList),fileOriginName:e.fileOriginName,fileSuffix:e.fileSuffix,fileSize:e.fileSize,filePath:e.fileName};this.$emit("handleFilesSuccess",t),this.loading.close()},handleBeforeUpload:function(e){var t=!1;if(this.fileType.length){var i="";e.name.lastIndexOf(".")>-1&&(i=e.name.slice(e.name.lastIndexOf(".")+1)),t=this.fileType.some((function(t){return e.type.indexOf(t)>-1||!!(i&&i.indexOf(t)>-1)}))}else t=e.type.indexOf("image")>-1;if(!t)return this.$message.error("文件格式不正确, 请上传".concat(this.fileType.join("/"),"格式文件!")),!1;if(this.fileSize){var n=e.size/1024/1024<this.fileSize;if(!n)return this.$message.error("上传文件大小不能超过 ".concat(this.fileSize," MB!")),!1}this.loading=this.$loading({lock:!0,text:"上传中",background:"rgba(0, 0, 0, 0.7)"})},handleUploadError:function(){this.$message({type:"error",message:"上传失败"}),this.loading.close()},listToString:function(e,t){var i="";for(var n in t=t||",",e)i+=e[n].url.replace(this.baseUrl,"")+t;return""!=i?i.substr(0,i.length-1):""}}},r=o,s=(i("34fa"),i("2877")),c=Object(s["a"])(r,n,a,!1,null,"71bdaa27",null);t["default"]=c.exports},c65d:function(e,t,i){"use strict";i("2f81")},f975:function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return l})),i.d(t,"c",(function(){return o}));var n=i("b775");function a(e){return Object(n["a"])({url:"/fileBlogInfo",method:"post",data:e})}function l(e){return Object(n["a"])({url:"/fileBlogInfo/"+e,method:"delete"})}function o(e){return Object(n["a"])({url:"/fileBlogInfo/"+e,method:"get"})}}}]);